<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spelling Game (Custom + Batches)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f0f8ff;
    }
    input[type="text"], textarea {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 15px;
      font-size: 16px;
      margin: 5px 5px 5px 0;
    }
    .result {
      margin-top: 20px;
      font-weight: bold;
    }
    .correct {
      color: green;
    }
    .incorrect {
      color: red;
    }
    .sentence {
      margin-top: 10px;
      font-style: italic;
    }
    .final-score {
      margin-top: 30px;
      font-weight: bold;
      font-size: 20px;
      color: navy;
    }
    .hint {
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Spelling Game</h1>
  <p>Paste your custom word list below (in JSON format: <code>[{"word": "example", "meaning": "...", "sentence": "..."}]</code>) or use the default:</p>
  <textarea id="customList" rows="8" placeholder='[{"word": "example", "meaning": "something you show", "sentence": "This is an example sentence."}]'></textarea>
  <button onclick="startGame()">Start Game</button>

  <div id="game" style="display:none;">
    <p id="definition"></p>
    <input type="text" id="userInput" autocomplete="off" />
    <button onclick="checkSpelling()">Check</button>
    <button onclick="giveHint()">Hint</button>
    <div id="hint" class="hint"></div>
    <div id="result" class="result"></div>
    <div id="sentence" class="sentence"></div>
    <button onclick="nextWord()">Next Word</button>
    <div id="finalScore" class="final-score"></div>
  </div>

  <script>
    let defaultList = [{"word": "accommodate", "meaning": "To provide space or a place for someone or something.", "sentence": "I will try to use the word 'accommodate' in a proper sentence."}, {"word": "accompany", "meaning": "To go somewhere with someone as a companion.", "sentence": "I will try to use the word 'accompany' in a proper sentence."}, {"word": "according", "meaning": "As stated by or in agreement with.", "sentence": "I will try to use the word 'according' in a proper sentence."}, {"word": "achieve", "meaning": "To succeed in reaching a goal, usually by effort.", "sentence": "I will try to use the word 'achieve' in a proper sentence."}, {"word": "aggressive", "meaning": "Ready or likely to attack or confront.", "sentence": "I will try to use the word 'aggressive' in a proper sentence."}, {"word": "amateur", "meaning": "A person who does something for enjoyment, not as a job.", "sentence": "I will try to use the word 'amateur' in a proper sentence."}, {"word": "ancient", "meaning": "Very old; from a long time ago.", "sentence": "I will try to use the word 'ancient' in a proper sentence."}, {"word": "apparent", "meaning": "Clearly visible or understood; obvious.", "sentence": "I will try to use the word 'apparent' in a proper sentence."}, {"word": "appreciate", "meaning": "To be thankful for something.", "sentence": "I really appreciate your help with my homework."}, {"word": "attached", "meaning": "Joined or connected to something.", "sentence": "I will try to use the word 'attached' in a proper sentence."}, {"word": "available", "meaning": "Able to be used or obtained.", "sentence": "I will try to use the word 'available' in a proper sentence."}, {"word": "average", "meaning": "A number expressing the central value of a set of numbers.", "sentence": "I will try to use the word 'average' in a proper sentence."}, {"word": "awkward", "meaning": "Clumsy or uncomfortable in movement or social situations.", "sentence": "I will try to use the word 'awkward' in a proper sentence."}, {"word": "bargain", "meaning": "Something bought or offered for less than usual price.", "sentence": "I will try to use the word 'bargain' in a proper sentence."}, {"word": "bruise", "meaning": "A dark mark on the skin caused by a hit or injury.", "sentence": "I will try to use the word 'bruise' in a proper sentence."}, {"word": "category", "meaning": "A group of things with shared characteristics.", "sentence": "I will try to use the word 'category' in a proper sentence."}, {"word": "cemetery", "meaning": "A place where dead people are buried.", "sentence": "I will try to use the word 'cemetery' in a proper sentence."}, {"word": "committee", "meaning": "A group of people chosen to do a specific task.", "sentence": "I will try to use the word 'committee' in a proper sentence."}, {"word": "communicate", "meaning": "To share or exchange information.", "sentence": "I will try to use the word 'communicate' in a proper sentence."}, {"word": "community", "meaning": "A group of people living in the same place or sharing interests.", "sentence": "I will try to use the word 'community' in a proper sentence."}, {"word": "competition", "meaning": "An event or activity in which people try to win.", "sentence": "I will try to use the word 'competition' in a proper sentence."}, {"word": "conscience", "meaning": "A person's sense of right and wrong.", "sentence": "He couldn\u2019t lie because his conscience wouldn\u2019t let him."}, {"word": "conscious", "meaning": "Awake and aware of what is happening.", "sentence": "She was conscious during the entire surgery."}, {"word": "controversy", "meaning": "A strong public disagreement or argument.", "sentence": "The book sparked a major controversy among readers."}, {"word": "convenience", "meaning": "Being easy and comfortable to use or do.", "sentence": "I will try to use the word 'convenience' in a proper sentence."}, {"word": "correspond", "meaning": "To match or be similar to something.", "sentence": "I will try to use the word 'correspond' in a proper sentence."}, {"word": "criticise", "meaning": "To point out the faults of something or someone.", "sentence": "I will try to use the word 'criticise' in a proper sentence."}, {"word": "curiosity", "meaning": "A strong desire to know or learn something.", "sentence": "I will try to use the word 'curiosity' in a proper sentence."}, {"word": "definite", "meaning": "Clearly stated or decided; not vague.", "sentence": "I will try to use the word 'definite' in a proper sentence."}, {"word": "desperate", "meaning": "Feeling or showing a hopeless sense of need.", "sentence": "I will try to use the word 'desperate' in a proper sentence."}, {"word": "determined", "meaning": "Having made a firm decision and being resolved not to change it.", "sentence": "I will try to use the word 'determined' in a proper sentence."}, {"word": "develop", "meaning": "To grow or cause to grow and become more advanced.", "sentence": "I will try to use the word 'develop' in a proper sentence."}, {"word": "dictionary", "meaning": "A book or online resource with word meanings.", "sentence": "I will try to use the word 'dictionary' in a proper sentence."}, {"word": "disastrous", "meaning": "Causing great damage or suffering.", "sentence": "I will try to use the word 'disastrous' in a proper sentence."}, {"word": "embarrass", "meaning": "To make someone feel awkward or ashamed.", "sentence": "She didn't want to embarrass her friend in public."}, {"word": "environment", "meaning": "The natural world or surroundings.", "sentence": "We must protect the environment from pollution."}, {"word": "equipped", "meaning": "Provided with necessary items.", "sentence": "I will try to use the word 'equipped' in a proper sentence."}, {"word": "especially", "meaning": "More than usual or particularly.", "sentence": "I will try to use the word 'especially' in a proper sentence."}, {"word": "exaggerate", "meaning": "To make something seem larger or more important than it is.", "sentence": "I will try to use the word 'exaggerate' in a proper sentence."}, {"word": "excellent", "meaning": "Very good or outstanding.", "sentence": "I will try to use the word 'excellent' in a proper sentence."}, {"word": "existence", "meaning": "The state of being real or alive.", "sentence": "Dinosaurs are no longer in existence."}, {"word": "explanation", "meaning": "A statement that makes something clear.", "sentence": "I will try to use the word 'explanation' in a proper sentence."}, {"word": "familiar", "meaning": "Well known from long or close association.", "sentence": "I will try to use the word 'familiar' in a proper sentence."}, {"word": "foreign", "meaning": "From another country.", "sentence": "I will try to use the word 'foreign' in a proper sentence."}, {"word": "forty", "meaning": "The number 40.", "sentence": "I will try to use the word 'forty' in a proper sentence."}, {"word": "frequently", "meaning": "Happening often.", "sentence": "I will try to use the word 'frequently' in a proper sentence."}, {"word": "government", "meaning": "The group of people who rule a country.", "sentence": "I will try to use the word 'government' in a proper sentence."}, {"word": "guarantee", "meaning": "A promise about the quality or performance of something.", "sentence": "I will try to use the word 'guarantee' in a proper sentence."}, {"word": "harass", "meaning": "To bother or attack repeatedly.", "sentence": "I will try to use the word 'harass' in a proper sentence."}, {"word": "hindrance", "meaning": "Something that delays or stops progress.", "sentence": "Her broken leg was a hindrance to her travel plans."}, {"word": "identity", "meaning": "Who or what someone is.", "sentence": "I will try to use the word 'identity' in a proper sentence."}, {"word": "immediate", "meaning": "Happening or done at once.", "sentence": "I will try to use the word 'immediate' in a proper sentence."}, {"word": "individual", "meaning": "Single; separate from others.", "sentence": "I will try to use the word 'individual' in a proper sentence."}, {"word": "interfere", "meaning": "To get involved in something that is not your business.", "sentence": "I will try to use the word 'interfere' in a proper sentence."}, {"word": "interrupt", "meaning": "To stop someone while they are speaking or doing something.", "sentence": "I will try to use the word 'interrupt' in a proper sentence."}, {"word": "language", "meaning": "The way we speak or write to communicate.", "sentence": "I will try to use the word 'language' in a proper sentence."}, {"word": "leisure", "meaning": "Free time when you are not working.", "sentence": "I will try to use the word 'leisure' in a proper sentence."}, {"word": "lightning", "meaning": "A flash of light in the sky during a storm.", "sentence": "I will try to use the word 'lightning' in a proper sentence."}, {"word": "marvellous", "meaning": "Extremely good or wonderful.", "sentence": "I will try to use the word 'marvellous' in a proper sentence."}, {"word": "mischievous", "meaning": "Naughty or playful in a sneaky way.", "sentence": "I will try to use the word 'mischievous' in a proper sentence."}, {"word": "muscle", "meaning": "Tissue in the body that helps you move.", "sentence": "I will try to use the word 'muscle' in a proper sentence."}];
    let fullList = [];
    let batch = [];
    let missedWords = [];
    let currentIndex = 0;
    let batchSize = 10;
    let batchNumber = 0;
    let attempt = 0;
    let totalCorrect = 0;
    let totalAttempts = 0;
    let currentWordScored = false;
    let hintLevel = 0;
    let revealedIndexes = [];

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function startGame() {
      const input = document.getElementById('customList').value.trim();
      try {
        fullList = input ? JSON.parse(input) : defaultList;
        shuffle(fullList);
        batchNumber = 0;
        nextBatch();
        document.getElementById('game').style.display = '';
        document.getElementById('customList').style.display = 'none';
        document.querySelector('button[onclick="startGame()"]').style.display = 'none';
      } catch (e) {
        alert("Invalid custom list. Please check your JSON format.");
      }
    }

    function nextBatch() {
      let start = batchNumber * batchSize;
      let end = start + batchSize;
      batch = fullList.slice(start, end);
      if (missedWords.length > 0) {
        batch = missedWords;
        missedWords = [];
      }
      if (batch.length === 0) {
        document.getElementById('definition').textContent = '';
        document.getElementById('userInput').style.display = 'none';
        document.querySelector('button[onclick="checkSpelling()"]').style.display = 'none';
        document.querySelector('button[onclick="giveHint()"]').style.display = 'none';
        document.querySelector('button[onclick="nextWord()"]').style.display = 'none';
        document.getElementById('hint').textContent = '';
        document.getElementById('result').textContent = '';
        document.getElementById('finalScore').textContent = "🎉 Game complete! Total Score: " + totalCorrect + " / " + totalAttempts;
        return;
      }
      currentIndex = 0;
      showWord();
    }

    function showWord() {
      const word = batch[currentIndex];
      document.getElementById('userInput').value = '';
      document.getElementById('result').textContent = '';
      document.getElementById('sentence').textContent = '';
      document.getElementById('hint').textContent = '';
      document.getElementById('definition').textContent = "Definition: " + word.meaning;
      document.getElementById('finalScore').textContent = '';
      attempt = 0;
      currentWordScored = false;
      hintLevel = 0;
      revealedIndexes = [0, word.word.length - 1];
    }

    function giveHint() {
      const word = batch[currentIndex].word;
      let hintArr = Array(word.length).fill("_");
      revealedIndexes.forEach(i => { hintArr[i] = word[i]; });
      if (hintLevel < 2) {
        let candidates = [];
        for (let i = 1; i < word.length - 1; i++) {
          if (!revealedIndexes.includes(i)) candidates.push(i);
        }
        if (candidates.length > 0) {
          let newIndex = candidates[Math.floor(Math.random() * candidates.length)];
          revealedIndexes.push(newIndex);
          revealedIndexes.sort((a,b)=>a-b);
          hintArr[newIndex] = word[newIndex];
        }
        hintLevel++;
      }
      document.getElementById('hint').textContent = "Hint: " + hintArr.join("");
    }

    function checkSpelling() {
      const userWord = document.getElementById('userInput').value.trim().toLowerCase();
      const correctWord = batch[currentIndex].word;
      const result = document.getElementById('result');
      const sentence = document.getElementById('sentence');

      if (userWord === correctWord) {
        result.textContent = "Correct! 🎉";
        result.className = "result correct";
        sentence.textContent = batch[currentIndex].sentence;
        if (!currentWordScored) {
          totalCorrect++;
          totalAttempts++;
          currentWordScored = true;
        }
      } else {
        attempt++;
        if (attempt >= 3 && !currentWordScored) {
          result.textContent = "Incorrect. The correct spelling is: " + correctWord;
          result.className = "result incorrect";
          sentence.textContent = batch[currentIndex].sentence;
          totalAttempts++;
          currentWordScored = true;
          missedWords.push(batch[currentIndex]);
        } else {
          result.textContent = "Incorrect. Try again.";
          result.className = "result incorrect";
        }
      }
    }

    function nextWord() {
      currentIndex++;
      if (currentIndex < batch.length) {
        showWord();
      } else {
        batchNumber++;
        document.getElementById('finalScore').textContent = "Batch Score: " + totalCorrect + " / " + totalAttempts;
        setTimeout(() => nextBatch(), 1500);
      }
    }
  </script>
</body>
</html>
